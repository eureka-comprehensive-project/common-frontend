<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>요금제 관리 - 관리자 대시보드</title>
    <link rel="stylesheet" href="../../../css/admin/common.css">
    <link rel="stylesheet" href="../../../css/admin/billing.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="dashboard-container">
        <!-- 사이드바는 sidebar-config.js에서 동적으로 생성 -->
        
        <main class="main-content">
            <header class="content-header">
                <div class="header-left">
                    <h1 class="page-title">요금제 관리</h1>
                    <p class="page-subtitle">시스템 요금제를 관리하고 모니터링합니다</p>
                </div>
                <div class="header-right">
                    <button class="btn btn-logout">
                        <i class="fas fa-sign-out-alt"></i>
                        로그아웃
                    </button>
                </div>
            </header>

            <div class="page-content">
                <!-- 요금제 통계 카드 -->
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="totalUsers">-</div>
                            <div class="stat-label">전체 사용자</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon premium">
                            <i class="fas fa-crown"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="premiumUsers">-</div>
                            <div class="stat-label">프리미엄 사용자</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon revenue">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="monthlyRevenue">-</div>
                            <div class="stat-label">월 매출</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon growth">
                            <i class="fas fa-trending-up"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-number" id="conversionRate">-</div>
                            <div class="stat-label">전환율</div>
                        </div>
                    </div>
                </div>

                <!-- 요금제 현황 카드 -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-credit-card"></i> 요금제 현황</h3>
                        <div class="header-controls">
                            <button class="btn btn-primary" id="addPlanBtn">
                                <i class="fas fa-plus"></i>
                                새 요금제 추가
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="plans-grid" id="plansGrid">
                            <!-- 요금제 카드들이 동적으로 생성됩니다 -->
                        </div>
                    </div>
                </div>

                <!-- 구독 관리 카드 -->
                <div class="card">
                    <div class="card-header">
                        <h3><i class="fas fa-list-alt"></i> 구독 관리</h3>
                        <div class="header-controls">
                            <div class="search-input-group">
                                <input type="text" id="subscriptionSearchInput" class="search-input" 
                                       placeholder="사용자 이름 또는 이메일 검색">
                                <button class="btn btn-search" id="subscriptionSearchBtn">
                                    <i class="fas fa-search"></i>
                                    검색
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="subscription-filters">
                            <div class="filter-group">
                                <label class="filter-label">상태 필터:</label>
                                <div class="radio-group-inline">
                                    <label class="radio-option">
                                        <input type="radio" name="statusFilter" value="all" checked>
                                        <span class="radio-custom"></span>
                                        <span class="radio-text">전체</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="statusFilter" value="active">
                                        <span class="radio-custom"></span>
                                        <span class="radio-text">활성</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="statusFilter" value="cancelled">
                                        <span class="radio-custom"></span>
                                        <span class="radio-text">취소</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="statusFilter" value="expired">
                                        <span class="radio-custom"></span>
                                        <span class="radio-text">만료</span>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="table-container">
                            <table class="data-table subscription-table">
                                <thead>
                                    <tr>
                                        <th width="60">번호</th>
                                        <th>사용자</th>
                                        <th>이메일</th>
                                        <th>요금제</th>
                                        <th>상태</th>
                                        <th>시작일</th>
                                        <th>만료일</th>
                                        <th>결제 금액</th>
                                        <th width="120">액션</th>
                                    </tr>
                                </thead>
                                <tbody id="subscriptionTableBody">
                                    <tr class="initial-state">
                                        <td colspan="9" class="text-center">
                                            <div class="empty-state">
                                                <i class="fas fa-search"></i>
                                                <h3>구독 정보를 검색해주세요</h3>
                                                <p>사용자 이름 또는 이메일로 검색할 수 있습니다</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- 요금제 추가/편집 모달 -->
    <div id="planModal" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> <span id="modalTitle">새 요금제 추가</span></h3>
                <button class="modal-close" id="planModalCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="planForm">
                    <div class="form-group">
                        <label class="form-label">요금제 이름</label>
                        <input type="text" id="planName" name="name" class="form-input" 
                               placeholder="예: 프리미엄 플랜" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">가격</label>
                            <input type="number" id="planPrice" name="price" class="form-input" 
                                   placeholder="0" min="0" step="100" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">기간 (일)</label>
                            <input type="number" id="planDuration" name="duration" class="form-input" 
                                   placeholder="30" min="1" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">설명</label>
                        <textarea id="planDescription" name="description" class="form-textarea" 
                                  placeholder="요금제 설명을 입력하세요" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">상태</label>
                        <div class="radio-group">
                            <label class="radio-option">
                                <input type="radio" name="status" value="active" checked>
                                <span class="radio-custom"></span>
                                <span class="radio-text">활성</span>
                            </label>
                            <label class="radio-option">
                                <input type="radio" name="status" value="inactive">
                                <span class="radio-custom"></span>
                                <span class="radio-text">비활성</span>
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="planModalCancelBtn">취소</button>
                <button class="btn btn-primary" id="planModalSaveBtn">
                    <i class="fas fa-save"></i>
                    저장
                </button>
            </div>
        </div>
    </div>

    <!-- 구독 상세 모달 -->
    <div id="subscriptionDetailModal" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h3><i class="fas fa-receipt"></i> 구독 상세 정보</h3>
                <button class="modal-close" id="subscriptionDetailCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="subscriptionDetailContent">
                    <div class="loading-spinner"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="subscriptionDetailCloseBtn2">닫기</button>
            </div>
        </div>
    </div>

    <!-- 스크립트 로드 -->
    <script src="../../../js/admin/common.js"></script>
    <script src="../../../js/admin/sidebar-config.js"></script>
    <script src="../../../js/admin/billing.js"></script>
</body>
</html>